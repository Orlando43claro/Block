<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bloc de Notas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }

        .container {
            padding: 20px;
        }

        h1 {
            text-align: center;
        }

        ul#listaNotas {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }

        ul#listaNotas li {
            background-color: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #ddd;
        }

        ul#listaNotas li:hover {
            background-color: #e0e0e0;
        }

        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #007bff;
            color: white;
            font-size: 24px;
            text-align: center;
            line-height: 50px;
            border: none;
            cursor: pointer;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);
        }

        .floating-btn:hover {
            background-color: #0056b3;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 300px;
            max-height: 50vh; /* Limitar altura del modal al 50% de la vista */
            overflow-y: auto; /* Habilitar scroll si el contenido excede la altura */
            text-align: center;
        }

        .modal-content input {
            width: 100%;
            margin-bottom: 20px;
            border-radius: 4px;
            padding: 10px;
            border: 1px solid #ccc;
        }

        .modal-content textarea {
            width: 100%;
            margin-bottom: 20px;
            border-radius: 4px;
            padding: 10px;
            border: 1px solid #ccc;
            resize: none;
            min-height: 100px; /* Altura mínima para el área de texto */
            max-height: 300px; /* Altura máxima para el área de texto */
        }

        .modal-content .buttons {
            display: flex;
            justify-content: space-around;
        }

        .modal-content button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
        }

        .modal-content button:hover {
            background-color: #0056b3;
        }

        .modal-content .close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Notas Guardadas</h1>
        <ul id="listaNotas"></ul>

        <!-- Botón flotante para agregar nota -->
        <button id="agregarNotaBtn" class="floating-btn">+</button>
    </div>

    <!-- Modal para agregar o editar notas -->
    <div id="notaModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <input id="tituloNota" type="text" placeholder="Título de la nota" />
            <textarea id="nota" placeholder="Escribe tu nota aquí..." oninput="ajustarAltura(this)"></textarea>
            <div class="buttons">
                <button id="guardarBtn">Guardar Nota</button>
                <button id="limpiarBtn">Limpiar Nota</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const listaNotas = document.getElementById('listaNotas');
            const agregarNotaBtn = document.getElementById('agregarNotaBtn');
            const notaModal = document.getElementById('notaModal');
            const cerrarModalBtn = document.querySelector('.close');
            const guardarBtn = document.getElementById('guardarBtn');
            const limpiarBtn = document.getElementById('limpiarBtn');
            const notaTextarea = document.getElementById('nota');
            const tituloInput = document.getElementById('tituloNota');

            let notasGuardadas = JSON.parse(localStorage.getItem('notas')) || [];
            let notaActualIndex = null; // Para saber si estamos editando una nota

            // Cargar las notas guardadas al inicio
            cargarNotas();

            // Abrir modal para agregar nueva nota
            agregarNotaBtn.addEventListener('click', function() {
                notaActualIndex = null;
                notaTextarea.value = '';
                tituloInput.value = '';
                notaModal.style.display = 'flex';  // Mostrar el modal
            });

            // Cerrar el modal
            cerrarModalBtn.addEventListener('click', function() {
                notaModal.style.display = 'none';  // Ocultar el modal
            });

            // Guardar nueva nota o editar
            guardarBtn.addEventListener('click', function() {
                const titulo = tituloInput.value;
                const nota = notaTextarea.value;
                if (titulo && nota) {
                    if (notaActualIndex === null) {
                        // Guardar nueva nota
                        guardarNota(titulo, nota);
                    } else {
                        // Editar nota existente
                        editarNota(notaActualIndex, titulo, nota);
                    }
                    notaTextarea.value = '';
                    tituloInput.value = '';
                    notaModal.style.display = 'none';  // Ocultar el modal después de guardar
                    cargarNotas();
                } else {
                    alert('Debes completar el título y la nota.');
                }
            });

            // Limpiar el área de texto
            limpiarBtn.addEventListener('click', function() {
                notaTextarea.value = '';
                tituloInput.value = '';
            });

            // Guardar nota en localStorage con título
            function guardarNota(titulo, nota) {
                notasGuardadas.unshift({ titulo: titulo, contenido: nota, fecha: new Date() }); // Agregar al inicio
                localStorage.setItem('notas', JSON.stringify(notasGuardadas));
            }

            // Editar nota existente
            function editarNota(index, titulo, nota) {
                notasGuardadas[index].titulo = titulo;
                notasGuardadas[index].contenido = nota;
                localStorage.setItem('notas', JSON.stringify(notasGuardadas));
            }

            // Cargar las notas en la lista
            function cargarNotas() {
                listaNotas.innerHTML = '';
                notasGuardadas.forEach((notaObj, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${notaObj.titulo}</strong>: ${notaObj.contenido.substring(0, 20)}...`; // Título en negrita
                    li.addEventListener('click', function() {
                        notaActualIndex = index;
                        tituloInput.value = notaObj.titulo;
                        notaTextarea.value = notaObj.contenido;
                        notaModal.style.display = 'flex';  // Mostrar modal para editar la nota
                    });
                    listaNotas.appendChild(li);
                });
            }

            // Ajustar la altura del textarea
            window.ajustarAltura = function(textarea) {
                textarea.style.height = 'auto'; // Reseteamos la altura
                textarea.style.height = (textarea.scrollHeight) + 'px'; // Ajustamos a su contenido
            }
        });
    </script>

</body>
</html>